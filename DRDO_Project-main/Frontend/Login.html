 
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>CARS DRDO - Login</title>
  <style>
    body {
      font-family: Arial, sans-serif;
    }

    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0; top: 0;
      width: 100%; height: 100%;
      overflow: auto;
      background-color: rgba(0, 0, 0, 0.5);
    }

    .modal-content {
      background-color: #fff;
      margin: 10% auto;
      padding: 20px;
      border-radius: 10px;
      width: 90%;
      max-width: 400px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }

    .close {
      float: right;
      font-size: 24px;
      cursor: pointer;
    }

    .modal-content h2 {
      text-align: center;
    }

    .modal-content form {
      display: flex;
      flex-direction: column;
    }

    .modal-content label {
      margin-top: 10px;
    }

    .modal-content input {
      padding: 8px;
      margin-top: 5px;
      border-radius: 5px;
      border: 1px solid #ccc;
    }

    .login-options {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-top: 20px;
    }

    .login-options button {
      padding: 10px;
      border: none;
      background-color: #1976d2;
      color: white;
      border-radius: 5px;
      cursor: pointer;
    }

    .login-options button:hover {
      background-color: #145ca1;
    }

    .signup-link {
      margin-top: 15px;
      text-align: center;
    }

    .signup-link a {
      color: #1976d2;
      text-decoration: none;
    }
  </style>
</head>
<body>

  <!-- Trigger Button -->
  <button id="openLoginModal">Login</button>

  <!-- Login Modal -->
  <div id="loginModal" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <h2>Login</h2>
      <form id="login-form">
        <label for="userid">User ID (Email)</label>
        <input type="text" id="userid" name="userid" required>

        <label for="password">Password</label>
        <input type="password" id="password" name="password" required>

        <div class="login-options">
          <button type="button" id="adminLoginBtn">Login as Admin</button>
          <button type="button" id="instituteLoginBtn">Login as Institute</button>
          <button type="button" id="instituteLoginBtn">Login as Director</button>
        </div>

        <p class="signup-link">Not a user? <a href="signup.html">Sign up</a></p>
      </form>
    </div>
  </div>

  <!-- Modal + Login Script -->
  <script>
    // Modal show/hide
    const modal = document.getElementById("loginModal");
    const btn = document.getElementById("openLoginModal");
    const span = document.getElementsByClassName("close")[0];

    btn.onclick = function () {
      modal.style.display = "block";
    }

    span.onclick = function () {
      modal.style.display = "none";
    }

    window.onclick = function (event) {
      if (event.target === modal) {
        modal.style.display = "none";
      }
    }

    // Login handlers
    const adminBtn = document.getElementById("adminLoginBtn");
    const instituteBtn = document.getElementById("instituteLoginBtn");

    async function login(role) {
      const userid = document.getElementById("userid").value;
      const password = document.getElementById("password").value;

      const res = await fetch("http://localhost:5000/api/auth/login", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          email: userid,
          password: password
        })
      });

      const data = await res.json();

      if (res.ok) {
        // ✅ Store token and user info
        localStorage.setItem("token", data.token);
        localStorage.setItem("userRole", data.user.role);
        localStorage.setItem("username", data.user.username);

        alert(`${data.user.role} Login successful!`);
        modal.style.display = "none";

        // ✅ Redirect based on role
        if (data.user.role.toLowerCase() === "admin") {
          window.location.href = "index.html";
        } else {
          window.location.href = "institute.html";
        }
      } else {
        alert(data.msg || "Login failed!");
      }
    }

    adminBtn.onclick = () => login("admin");
    instituteBtn.onclick = () => login("institute");
  </script>

</body>
</html>


